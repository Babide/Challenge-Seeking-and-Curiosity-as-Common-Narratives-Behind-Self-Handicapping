---
title: "SH_SD"
author: "TL"
date: "2022-09-02"
output: html_document
---

```{r}
library(lavaan)
library(emmeans)
library(ggplot2)
library(nlme)
library(haven)
library(tidyr)
library(sjPlot)
library(cowplot)
library(scales)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r}
d <- SD_Data_clean
d$SH_kat <- as.factor(d$SH_kat)
d$SH_kat <- recode_factor(d$SH_kat, `0` = "Did not Select Debilitation Music Option", `1` = "Selected Debilitating Music Option")
table(d$SH_kat)

d$Condition <- as.factor(d$Condition)
d$Condition <- recode_factor(d$Condition, `1` = "Fixed Mindset", `2` = "Growth Mindset")
table(d$Condition)

d$Gender <- recode_factor(d$Gender, `1` = "Male", `2` = "Female")
table(d$Gender)

d$kiváncsi <- as.factor(d$kiváncsi)
d$kiváncsi <- recode_factor(d$kiváncsi, `1` = "Explained with Curiosity", `0` = "Did not Explain with Curiosity")
table(d$kiváncsi)

d$kihiváskeresés <- as.factor(d$kihiváskeresés)
d$kihiváskeresés <- recode_factor(d$kihiváskeresés, `1` = "Explained with Challenge-Seeking", `0` = "Did not Explain with Challenge-Seeking")
table(d$kihiváskeresés)

d$kivácsiazenére <- as.factor(d$kivácsiazenére)
d$kivácsiazenére <- recode_factor(d$kivácsiazenére, `1` = "Explained with Curiosity to the Music", `0` = "Did not Explain with Curiosity to the Music")
table(d$kivácsiazenére)

d$kiváncsimagára <- as.factor(d$kiváncsimagára)
d$kiváncsimagára <- recode_factor(d$kiváncsimagára, `1` = "Explained with Curiosity to Themselves", `0` = "Did not Explain with Curiosity to Themselves")
table(d$kiváncsimagára)

d$egyet_c <- recode_factor(d$Egyetem, `ELTE` = "Science University", `TF` = "Sports University")
table(d$egyet_c)
```


```{r}
d$kiv <- as.factor(d$kiváncsi)
d$kihiv <- as.factor(d$kihiváskeresés)
d$cond <- as.factor(d$Condition)
d$gender <- as.factor(d$Gender)
d$gender <- as.factor(d$Gender)
d$sh <- as.factor(d$SH_kat)
d$kivz <- as.factor(d$kivácsiazenére)
d$kivm <- as.factor(d$kiváncsimagára)
d$egyet <- as.factor(d$Egyetem)
d$Kihiv_atl <- as.numeric(d$Kihiv_atl)
d$BSH <- as.numeric(d$BSH)
```

```{r}
mod <- glm(kiváncsi ~ SH_kat + Gender + Condition + egyet_c, family = "binomial", data = d)
summary(mod)
tab_model(mod, show.stat = T, use.viewer = T)

k <- plot_model(mod, type = "pred", terms = "SH_kat", colors = "gs", align = c("v"), title = "", axis.title = c("Participants Based on the Selected Music Option", "Curiosity Explanation Among Participants"))+ 
  geom_bar(position=position_dodge(), stat = "identity", width=0.5, alpha=0.7) + 
  coord_cartesian(ylim=c(0,1))+
  scale_fill_grey()+
  theme_classic()

mod2 <- glm(kivácsiazenére ~ SH_kat + Gender + Condition + egyet_c, family = "binomial", data = d)
summary(mod2)
tab_model(mod2, show.stat = T, use.viewer = T)

kk <- plot_model(mod2, type = "pred", terms = "SH_kat", colors = "gs", align = c("v"), title = "", axis.title = c("Participants Based on the Selected Music Option", "Curiosity to the Music Explanation Among Participants"))+ 
  geom_bar(position=position_dodge(), stat = "identity", width=0.5, alpha=0.7) + 
  coord_cartesian(ylim=c(0,1))+
  scale_fill_grey()+
  theme_classic()

mod3 <- glm(kiváncsimagára ~ SH_kat + Gender + Condition + egyet_c, family = "binomial", data = d)
summary(mod3)
tab_model(mod3, show.stat = T, use.viewer = T)

kkk <- plot_model(mod3, type = "pred", terms = "SH_kat", colors = "gs", align = c("v"), title = "", axis.title = c("Participants Based on the Selected Music Option", "Curiosity to Themselves Explanation Among Participants"))+ 
  geom_bar(position=position_dodge(), stat = "identity", width=0.5, alpha=0.7) + 
  coord_cartesian(ylim=c(0,1))+
  scale_fill_grey()+
  theme_classic()

plot_fig <- plot_grid(k, kk, kkk, align = c("h"), scale = 1, ncol=3, nrow=1)
plot_fig
```
